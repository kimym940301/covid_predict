# 경제와 코로나 데이터를 통한 코로나19 동향 예측

## 개발동기
  - 미래에 또 다른 전염성 유행병이 발병하면 코로나19의 경험을 통해 국가적 방역 대책이 시행될 것이고 방역 대책이나 다양한 우발상 황에 따른 확진자의 변화가 코로나19와 유사하게 진행될 것이라고 생각한다
  - [한국정보통신학회논문지 “시계열 데이터를 활용한 코로나19 동향 예측”(수원대학교 논문)] (https://www.kci.go.kr/kciportal/ci/sereArticleSearch/ciSereArtiView.kci?sereArticleSearchBean.artiId=ART002741446)이 라는 코로나 데이터를 시계열 데이터를 통한 확진자 예측 모델를 기반

## 분석목표
  - 코로나와 경제 데이터를 통해 다음날 코로나 확진자를 예측하는 모델 생성 
  - 초기 예측이 어려운 시계열 데이터를 통한 모델이 아닌 다양한 데이터를 통한 모델 생성
  
## 모델 소개
  - 코로나 전날 확진자와 관련 데이터(경제 데이터)를 통해 다음날 확진자 예측

## 사용한 데이터 및 전처리
  - 정부 발표자료를 통한 데이터 수집 
    - 데이터 전처리 
    - 코로나 데이터, 백신 데이터, 국가 통제 
  - 경제 및 국가 통제 데이터 수집
    - 데이터 전처리
    - 국가 경제 데이터, 국민 경제 데이터, 환율 데이터

## 분석과정
1. 코로나 데이터를 적용한 모델 생성
  - 코로나 첫 확진자 발생일 인 2020년 1월 20일 부터 2022년 12월 31일 까지의 코로나 확진자, 사망자, 백신 접종자, 국가 통제(사회적 거리두기), 년, 월, 요일 컬럼을 통한 다음 날 확진자 예측 모델 생성
  - 최초 베이스라인 모델의 경우 target(코로나 확진자)의 값이 0이 많아 정규분포 모형이 아니기 때문에 target에 log를 통해 정규분포 모형 생성(시각화)
  - 성능 지표 중 MAE를 통해 실제값과 예측값 의 오차를 비교해서 MAE가 낮은 모델을 적 용해서 모델을 생성
  - 회귀분석을 통한 예측(OLS모델을 통한 최적화로 Decision Tree 모델 적용)
    - 모델 중 회귀분석에 서 등분산성, 독립성, 선형성 등 수치에서 자유로운 Tree 모델이 MAE가 낮게 나와 적용   
2. 코로나 + 경제 데이터를 적용한 모델 생성
  - 초기 모델 작성 시 코로나19 이전의 경제 동향을 확인하기 위해 2018년부터 데이터를 적용했 으나 코로나 발생 이전까지 코로나19의 모든 컬럼이 0으로 입력해 모델 성능에 영향을 주 어 결정계수가 무의미하게 높게 나온다.
  - 코로나19 국내 발생 일자에 따라 2020 년 1월 20일부터 2022년 12월 31일까지 범위 의 데이터를 사용
  - 기존 코로나19와 경제 데이터를 새로 병합 하여 사용, 코로나19 데이터와 동일한 초 기 모델은 target값에 0이 많아 정규분포 모형이 아니여서 log를 통해 정규분포 모 형으로 만들어 단위가 독립변수들은 scale하 고 모델에 적용
  - 코로나만 적용한 모델보다는 성능이 향상되었으나 Cond. No.가 148로 다중공선성이 의심
  - target값과 다른 독립 변수들의 상관관계가 높은 컬럼을 제외한 모 델을 만들고 p-value가 높은 컬럼을 제외해 최적화를 시도
  - 코로나 데이터만 사용한 모델과 동일하게 성능 지표 중 MAE를 통해 실제값과 예측값 의 오차를 비교해서 MAE가 낮은 모델을 적 용해서 모델을 생성
  - 상관계수를 확인해 0.3 이하 컬럼을 제외하고 모델을 생성했으나 MAE가 6000 이상만 나와 상관계수를 통한 최적화가 아닌 p-value에 따라 제외해 모델 을 최적화
  - Optuna를 통해 Catboost와 lightgbm 모델의 하이퍼파라미터 튜닝을 통해 모델 최적화를 시도했으나 MAE가 증가해서 기존 모델을 적용
  - 마찬가지로 Catboost, Lightgbm, Extratree, Gradientboost, xgboost 모델을 다양하게 조합 해 Voting으로 모델을 생성했으나 MAE값이 여전히 높게 나와 p-value를 통한 모델 최적 화를 최종모델로 선정

## 분석 결과
  - 코로나 데이터 적용 예측 모델
     → OLS R-Squared : 0.937 / Tree R-Squared : 0.994, MAE : 2599
  - 코로나 + 경제 데이터 적용 예측 모델
     → OLS R-Squared : 0.938 / Tree R-Squared : 0.994, MAE : 2378.657
  - 하이퍼파라미터 튜닝 / Voting 적용
     → R-Squared : 0.99385, MAE : 3063.053 / 0.99301, MAE : 2971.491
  - 최종 모델(코로나 + 경제 데이터에 p-value 높은 컬럼 제거한 모델)
    → OLS R-Squared : 0.938 / Tree R-Squared : 0.994, MAE : 2378.657


## 사용기술 및 개발환경
  - 데이터 출처: 코로나 정부 사이트, 데이터 거래소, 정부 발표자료 참고, 야후(경제)
  - 수집방법: csv 파일 다운로드
  - 개발도구 : pandas, numpy, seaborn, sklearn
  - 개발언어 및 프레임워크 : python, jupyter notebook
  
